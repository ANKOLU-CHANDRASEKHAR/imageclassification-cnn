import tensorflow as tf
import cv2
import matplotlib.pyplot as plt
import numpy as np

# Load trained model
model = tf.keras.models.load_model('cnn_dog_cat_model.h5')

# Read test image
img = cv2.imread('test_image.jpg')
img = cv2.resize(img, (256, 256))
img = img / 255.0

# Prepare image for prediction
input_img = np.reshape(img, (1, 256, 256, 3))

# Predict
prediction = model.predict(input_img)

# Show image
plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
plt.axis('off')
plt.show()

# Result
if prediction[0][0] < 0.5:
    print("Prediction: CAT")
else:
    print("Prediction: DOG")
